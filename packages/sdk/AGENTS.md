# Repository Guidelines

## Project Structure & Module Organization
This package is a TypeScript SDK published as `@segmentationapi/sdk`.

- `src/`: SDK source code (`client.ts`, `validation.ts`, `errors.ts`, etc.)
- `test/`: Vitest test suite (for example `test/client.test.ts`)
- `dist/`: build output (generated by `tsup`; do not edit manually)
- `.github/workflows/publish.yml`: npm publish pipeline triggered by version tags

Keep public exports centralized through `src/index.ts` so the package surface stays explicit.

## Build, Test, and Development Commands
Use `pnpm` (see `packageManager` in `package.json`).

- `pnpm build`: compile ESM + `.d.ts` into `dist/`
- `pnpm test`: run tests once with Vitest
- `pnpm test:watch`: run tests in watch mode during development
- `pnpm typecheck`: run strict TypeScript checks without emitting files
- `pnpm clean`: remove `dist/` and `coverage/`

Before publishing, run: `pnpm build && pnpm test && pnpm typecheck`.

## Coding Style & Naming Conventions
- Language: TypeScript (`strict` mode enabled).
- Indentation: 2 spaces; use semicolons and double quotes (match existing files).
- Modules: ESM with NodeNext resolution; use `.js` extensions in relative imports (for emitted ESM compatibility).
- Naming: `PascalCase` for classes/types, `camelCase` for functions/variables, `UPPER_SNAKE_CASE` for constants.
- File names: short, lowercase, feature-oriented (for example `normalize.ts`, `client.ts`).

## Testing Guidelines
- Framework: Vitest (`environment: node`).
- Test pattern: `test/**/*.test.ts`.
- Add/extend tests for every behavior change, especially request/response validation and error handling paths.
- No enforced coverage threshold is configured; focus on meaningful assertions for edge cases and failure modes.

## Commit & Pull Request Guidelines
History mostly follows Conventional Commit prefixes (`feat:`, `fix:`, `chore:`). Use that style when possible.

- Commit messages: imperative and scoped (example: `fix: handle jwt upload error body`).
- PRs should include:
  - clear summary of behavioral changes
  - linked issue/ticket (if applicable)
  - test evidence (`pnpm test`, `pnpm typecheck`)

## Release & Security Notes
- Publishing is tag-driven: pushing `v*` tags triggers `.github/workflows/publish.yml`.
- Never commit API keys or JWTs; use environment variables and test doubles/mocks.
